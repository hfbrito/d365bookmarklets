javascript:%28function%28%29%7Bvar allTopics%3D%5B%5D%3Bfunction showTopicExplorerModal%28%29%7Bvar modal%3Ddocument.createElement%28%27div%27%29%3Bmodal.style.position%3D%27fixed%27%3Bmodal.style.top%3D%2750%25%27%3Bmodal.style.left%3D%2750%25%27%3Bmodal.style.transform%3D%27translate%28-50%25%2C -50%25%29%27%3Bmodal.style.padding%3D%2720px%27%3Bmodal.style.backgroundColor%3D%27%23fff%27%3Bmodal.style.boxShadow%3D%270 0 10px rgba%280%2C0%2C0%2C0.5%29%27%3Bmodal.style.zIndex%3D%2710000%27%3Bmodal.style.borderRadius%3D%278px%27%3Bmodal.style.fontFamily%3D%27Arial%2C sans-serif%27%3Bmodal.style.maxHeight%3D%2780%25%27%3Bmodal.style.overflowY%3D%27auto%27%3Bvar title%3Ddocument.createElement%28%27h3%27%29%3Btitle.textContent%3D%27Explorador de Assuntos do Dynamics 365%27%3Btitle.style.marginBottom%3D%2715px%27%3Btitle.style.color%3D%27%23333%27%3Bmodal.appendChild%28title%29%3Bvar searchInput%3Ddocument.createElement%28%27input%27%29%3BsearchInput.type%3D%27text%27%3BsearchInput.placeholder%3D%27Pesquisar assunto...%27%3BsearchInput.style.width%3D%27calc%28100%25 - 20px%29%27%3BsearchInput.style.padding%3D%2710px%27%3BsearchInput.style.marginBottom%3D%2715px%27%3BsearchInput.style.border%3D%271px solid %23ccc%27%3BsearchInput.style.borderRadius%3D%274px%27%3BsearchInput.style.boxSizing%3D%27border-box%27%3Bmodal.appendChild%28searchInput%29%3Bvar topicListContainer%3Ddocument.createElement%28%27div%27%29%3BtopicListContainer.style.maxHeight%3D%27500px%27%3BtopicListContainer.style.overflowY%3D%27auto%27%3BtopicListContainer.style.border%3D%271px solid %23eee%27%3BtopicListContainer.style.borderRadius%3D%274px%27%3BtopicListContainer.style.padding%3D%2710px%27%3BtopicListContainer.style.marginBottom%3D%2715px%27%3Bmodal.appendChild%28topicListContainer%29%3Bfunction renderTopics%28parentTopicId%2CcontainerElement%2Clevel%3D0%2CfilteredTopicIds%3Dnull%29%7Bvar topicsToRender%3DallTopics.filter%28t%3D>%28t.parentsubject%3D%3Dnull%26%26parentTopicId%3D%3Dnull%29%7C%7C%28t.parentsubject%21%3Dnull%26%26t.parentsubject.subjectid%3D%3DparentTopicId%29%29%3Bif%28filteredTopicIds%29%7BtopicsToRender%3DtopicsToRender.filter%28t%3D>filteredTopicIds.includes%28t.subjectid%29%7C%7CcontainsFilteredChild%28t.subjectid%2CfilteredTopicIds%29%29%3B%7D%0AtopicsToRender.sort%28%28a%2Cb%29%3D>a.title.localeCompare%28b.title%29%29%3Bif%28topicsToRender.length%3D%3D%3D0%26%26level%3D%3D%3D0%26%26filteredTopicIds%26%26searchInput.value%21%3D%3D%27%27%29%7Bvar noResults%3Ddocument.createElement%28%27p%27%29%3BnoResults.textContent%3D%27Nenhum assunto encontrado com este termo.%27%3BnoResults.style.textAlign%3D%27center%27%3BnoResults.style.color%3D%27%23777%27%3BcontainerElement.appendChild%28noResults%29%3Breturn%3B%7D%0AtopicsToRender.forEach%28topic%3D>%7Bvar hasChildren%3DallTopics.some%28t%3D>t.parentsubject%21%3Dnull%26%26t.parentsubject.subjectid%3D%3Dtopic.subjectid%29%3Bvar topicItem%3Ddocument.createElement%28%27div%27%29%3BtopicItem.style.display%3D%27flex%27%3BtopicItem.style.alignItems%3D%27center%27%3BtopicItem.style.justifyContent%3D%27space-between%27%3BtopicItem.style.padding%3D%278px%27%3BtopicItem.style.marginBottom%3D%273px%27%3BtopicItem.style.border%3D%271px solid %23ddd%27%3BtopicItem.style.borderRadius%3D%274px%27%3BtopicItem.style.backgroundColor%3D%27%23f9f9f9%27%3BtopicItem.style.cursor%3DhasChildren%3F%27pointer%27%3A%27default%27%3BtopicItem.style.transition%3D%27background-color 0.2s ease%27%3BtopicItem.style.marginLeft%3D%60%24%7Blevel*20%7D%0Apx%60%3Bvar topicNameAndIndicator%3Ddocument.createElement%28%27span%27%29%3BtopicNameAndIndicator.style.flexGrow%3D%271%27%3BtopicNameAndIndicator.style.fontWeight%3Dlevel%3D%3D%3D0%3F%27bold%27%3A%27normal%27%3Bvar indicatorSpan%3Ddocument.createElement%28%27span%27%29%3BindicatorSpan.style.marginRight%3D%278px%27%3BindicatorSpan.style.width%3D%2712px%27%3BindicatorSpan.style.textAlign%3D%27center%27%3Bif%28hasChildren%29%7BindicatorSpan.textContent%3D%27%5Cu25B6%27%3BindicatorSpan.style.color%3D%27%23555%27%3BindicatorSpan.style.fontSize%3D%270.8em%27%3BtopicItem.onmouseover%3Dfunction%28%29%7Bthis.style.backgroundColor%3D%27%23e6e6e6%27%3B%7D%3BtopicItem.onmouseout%3Dfunction%28%29%7Bif%28childrenContainer.style.display%3D%3D%3D%27none%27%29%7Bthis.style.backgroundColor%3D%27%23f9f9f9%27%3B%7D%7D%3B%7Delse%7BindicatorSpan.textContent%3D%27%27%3B%7D%0AtopicNameAndIndicator.appendChild%28indicatorSpan%29%3BtopicNameAndIndicator.appendChild%28document.createTextNode%28topic.title%29%29%3Bvar copyGuidButton%3Ddocument.createElement%28%27button%27%29%3BcopyGuidButton.textContent%3D%27Copiar GUID%27%3BcopyGuidButton.style.marginLeft%3D%2710px%27%3BcopyGuidButton.style.padding%3D%275px 8px%27%3BcopyGuidButton.style.border%3D%271px solid %236c757d%27%3BcopyGuidButton.style.borderRadius%3D%274px%27%3BcopyGuidButton.style.backgroundColor%3D%27%236c757d%27%3BcopyGuidButton.style.color%3D%27%23fff%27%3BcopyGuidButton.style.cursor%3D%27pointer%27%3BcopyGuidButton.style.transition%3D%27background-color 0.2s ease%2C border-color 0.2s ease%27%3BcopyGuidButton.style.fontSize%3D%270.85em%27%3BcopyGuidButton.onmouseover%3Dfunction%28%29%7Bthis.style.backgroundColor%3D%27%235a6268%27%3Bthis.style.borderColor%3D%27%235a6268%27%3B%7D%3BcopyGuidButton.onmouseout%3Dfunction%28%29%7Bthis.style.backgroundColor%3D%27%236c757d%27%3Bthis.style.borderColor%3D%27%236c757d%27%3B%7D%3BcopyGuidButton.onclick%3Dfunction%28event%29%7Bevent.stopPropagation%28%29%3Bnavigator.clipboard.writeText%28topic.subjectid%29.then%28%28%29%3D>%7BcopyGuidButton.textContent%3D%27GUID Copiado%21%27%3BcopyGuidButton.style.backgroundColor%3D%27%2328a745%27%3BcopyGuidButton.style.borderColor%3D%27%2328a745%27%3BsetTimeout%28%28%29%3D>%7BcopyGuidButton.textContent%3D%27Copiar GUID%27%3BcopyGuidButton.style.backgroundColor%3D%27%236c757d%27%3BcopyGuidButton.style.borderColor%3D%27%236c757d%27%3B%7D%2C1500%29%3B%7D%29.catch%28err%3D>%7Balert%28%27Erro ao copiar GUID%3A %27+err%29%3B%7D%29%3B%7D%3Bvar copySubtreeButton%3Ddocument.createElement%28%27button%27%29%3BcopySubtreeButton.textContent%3D%27Copiar Subárvore%27%3BcopySubtreeButton.style.marginLeft%3D%2710px%27%3BcopySubtreeButton.style.padding%3D%275px 8px%27%3BcopySubtreeButton.style.border%3D%271px solid %23007bff%27%3BcopySubtreeButton.style.borderRadius%3D%274px%27%3BcopySubtreeButton.style.backgroundColor%3D%27%23007bff%27%3BcopySubtreeButton.style.color%3D%27%23fff%27%3BcopySubtreeButton.style.cursor%3D%27pointer%27%3BcopySubtreeButton.style.transition%3D%27background-color 0.2s ease%2C border-color 0.2s ease%27%3BcopySubtreeButton.style.fontSize%3D%270.85em%27%3BcopySubtreeButton.onmouseover%3Dfunction%28%29%7Bthis.style.backgroundColor%3D%27%230056b3%27%3Bthis.style.borderColor%3D%27%230056b3%27%3B%7D%3BcopySubtreeButton.onmouseout%3Dfunction%28%29%7Bthis.style.backgroundColor%3D%27%23007bff%27%3Bthis.style.borderColor%3D%27%23007bff%27%3B%7D%3BcopySubtreeButton.onclick%3Dfunction%28event%29%7Bevent.stopPropagation%28%29%3Bvar subTreeText%3DgetSubTreeText%28topic%2C0%29%3Bnavigator.clipboard.writeText%28subTreeText%29.then%28%28%29%3D>%7BcopySubtreeButton.textContent%3D%27Copiado%21%27%3BcopySubtreeButton.style.backgroundColor%3D%27%2328a745%27%3BcopySubtreeButton.style.borderColor%3D%27%2328a745%27%3BsetTimeout%28%28%29%3D>%7BcopySubtreeButton.textContent%3D%27Copiar Subárvore%27%3BcopySubtreeButton.style.backgroundColor%3D%27%23007bff%27%3BcopySubtreeButton.style.borderColor%3D%27%23007bff%27%3B%7D%2C1500%29%3B%7D%29.catch%28err%3D>%7Balert%28%27Erro ao copiar%3A %27+err%29%3B%7D%29%3B%7D%3BtopicItem.appendChild%28topicNameAndIndicator%29%3BtopicItem.appendChild%28copyGuidButton%29%3BtopicItem.appendChild%28copySubtreeButton%29%3BcontainerElement.appendChild%28topicItem%29%3Bvar childrenContainer%3Ddocument.createElement%28%27div%27%29%3BchildrenContainer.style.display%3D%27none%27%3BcontainerElement.appendChild%28childrenContainer%29%3Bif%28hasChildren%29%7BtopicItem.onclick%3Dfunction%28%29%7Bif%28childrenContainer.style.display%3D%3D%3D%27none%27%29%7BchildrenContainer.innerHTML%3D%27%27%3BrenderTopics%28topic.subjectid%2CchildrenContainer%2Clevel+1%29%3BchildrenContainer.style.display%3D%27block%27%3BtopicItem.style.backgroundColor%3D%27%23e0e0e0%27%3BindicatorSpan.textContent%3D%27%5Cu25BC%27%3B%7Delse%7BchildrenContainer.style.display%3D%27none%27%3BtopicItem.style.backgroundColor%3D%27%23f9f9f9%27%3BindicatorSpan.textContent%3D%27%5Cu25B6%27%3B%7D%7D%3B%7D%7D%29%3B%7D%0Afunction containsFilteredChild%28parentId%2CfilteredIds%29%7Breturn allTopics.some%28t%3D>%7Bif%28t.parentsubject%26%26t.parentsubject.subjectid%3D%3D%3DparentId%29%7Bif%28filteredIds.includes%28t.subjectid%29%29%7Breturn true%3B%7D%0Areturn containsFilteredChild%28t.subjectid%2CfilteredIds%29%3B%7D%0Areturn false%3B%7D%29%3B%7D%0Afunction getSubTreeText%28topic%2Clevel%29%7Blet text%3D%27%27%3Blet indent%3D%27  %27.repeat%28level%29%3Btext+%3D%60%24%7Bindent%7D-%24%7Btopic.title%7D%5Cn%60%3Bvar children%3DallTopics.filter%28t%3D>t.parentsubject%21%3Dnull%26%26t.parentsubject.subjectid%3D%3Dtopic.subjectid%29%3Bchildren.sort%28%28a%2Cb%29%3D>a.title.localeCompare%28b.title%29%29%3Bchildren.forEach%28child%3D>%7Btext+%3DgetSubTreeText%28child%2Clevel+1%29%3B%7D%29%3Breturn text%3B%7D%0Afunction filterAndRenderTopics%28%29%7BtopicListContainer.innerHTML%3D%27%27%3Bconst searchTerm%3DsearchInput.value.toLowerCase%28%29%3Bif%28searchTerm%3D%3D%3D%27%27%29%7BrenderTopics%28null%2CtopicListContainer%2C0%29%3B%7Delse%7Bconst matchingTopics%3DallTopics.filter%28topic%3D>topic.title.toLowerCase%28%29.includes%28searchTerm%29%29%3Bconst topicsToShowIds%3Dnew Set%28%29%3BmatchingTopics.forEach%28match%3D>%7BtopicsToShowIds.add%28match.subjectid%29%3Blet currentTopic%3Dmatch%3Bwhile%28currentTopic%26%26currentTopic.parentsubject%29%7Bconst parent%3DallTopics.find%28t%3D>t.subjectid%3D%3D%3DcurrentTopic.parentsubject.subjectid%29%3Bif%28parent%29%7BtopicsToShowIds.add%28parent.subjectid%29%3BcurrentTopic%3Dparent%3B%7Delse%7Bbreak%3B%7D%7D%7D%29%3BrenderTopics%28null%2CtopicListContainer%2C0%2CArray.from%28topicsToShowIds%29%29%3B%7D%7D%0AsearchInput.addEventListener%28%27input%27%2CfilterAndRenderTopics%29%3BfilterAndRenderTopics%28%29%3Bvar closeButton%3Ddocument.createElement%28%27button%27%29%3BcloseButton.textContent%3D%27Fechar%27%3BcloseButton.style.padding%3D%2710px 20px%27%3BcloseButton.style.border%3D%27none%27%3BcloseButton.style.borderRadius%3D%274px%27%3BcloseButton.style.backgroundColor%3D%27%23dc3545%27%3BcloseButton.style.color%3D%27%23fff%27%3BcloseButton.style.cursor%3D%27pointer%27%3BcloseButton.style.float%3D%27right%27%3BcloseButton.onclick%3Dfunction%28%29%7Bdocument.body.removeChild%28modal%29%3B%7D%3Bmodal.appendChild%28closeButton%29%3Bdocument.body.appendChild%28modal%29%3BsearchInput.focus%28%29%3B%7D%0Avar webApiUrl%3DXrm.Utility.getGlobalContext%28%29.getClientUrl%28%29+"/api/data/v9.1/subjects%3F%24select%3Dtitle%2Csubjectid%2C_parentsubject_value%26%24orderby%3Dtitle asc"%3Bfetch%28webApiUrl%2C%7Bmethod%3A%27GET%27%2Cheaders%3A%7B%27OData-MaxVersion%27%3A%274.0%27%2C%27OData-Version%27%3A%274.0%27%2C%27Accept%27%3A%27application/json%27%2C%27Content-Type%27%3A%27application/json%3B charset%3Dutf-8%27%2C%7D%7D%29.then%28response%3D>%7Bif%28%21response.ok%29%7Breturn response.json%28%29.then%28errorData%3D>%7Bconst errorMessage%3DerrorData%26%26errorData.error%26%26errorData.error.message%3FerrorData.error.message%3Aresponse.statusText%3Bthrow new Error%28%60Erro de rede ou API%3A%24%7Bresponse.status%7D-%24%7BerrorMessage%7D%60%29%3B%7D%29.catch%28%28%29%3D>%7Bthrow new Error%28%27Network response was not ok %27+response.statusText%29%3B%7D%29%3B%7D%0Areturn response.json%28%29%3B%7D%29.then%28data%3D>%7BallTopics%3Ddata.value.map%28topic%3D>%28%7Bsubjectid%3Atopic.subjectid%2Ctitle%3Atopic.title%2Cparentsubject%3Atopic._parentsubject_value%3F%7Bsubjectid%3Atopic._parentsubject_value%7D%3Anull%7D%29%29%3Bif%28allTopics.length%3D%3D%3D0%29%7Balert%28%27Nenhum assunto encontrado ou o usuário não tem permissão para ler assuntos.%27%29%3Breturn%3B%7D%0AshowTopicExplorerModal%28%29%3B%7D%29.catch%28error%3D>%7Balert%28%27Erro ao buscar assuntos%3A %27+error.message+%27. Possíveis causas%3A permissões insuficientes%2C URL da API incorreta ou bloqueio de rede.%27%29%3Bconsole.error%28%27Detalhes do erro de busca de assuntos%3A%27%2Cerror%29%3B%7D%29%3B%7D%29%28%29%3B
