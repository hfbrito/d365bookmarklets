javascript:javascript%3A%28function%28%29%7Bfunction showModal%28apps%29%7Bvar modal%3Ddocument.createElement%28%27div%27%29%3Bmodal.style.position%3D%27fixed%27%3Bmodal.style.top%3D%2750%25%27%3Bmodal.style.left%3D%2750%25%27%3Bmodal.style.transform%3D%27translate%28-50%25%2C -50%25%29%27%3Bmodal.style.padding%3D%2720px%27%3Bmodal.style.backgroundColor%3D%27%23fff%27%3Bmodal.style.boxShadow%3D%270 0 10px rgba%280%2C0%2C0%2C0.5%29%27%3Bmodal.style.zIndex%3D%2710000%27%3Bmodal.style.borderRadius%3D%278px%27%3Bmodal.style.fontFamily%3D%27Arial%2C sans-serif%27%3Bmodal.style.maxHeight%3D%2780%25%27%3Bmodal.style.overflowY%3D%27auto%27%3Bvar title%3Ddocument.createElement%28%27h3%27%29%3Btitle.textContent%3D%27Selecione um Aplicativo do Dynamics 365%27%3Btitle.style.marginBottom%3D%2715px%27%3Btitle.style.color%3D%27%23333%27%3Bmodal.appendChild%28title%29%3Bvar appListContainer%3Ddocument.createElement%28%27div%27%29%3BappListContainer.style.maxHeight%3D%27480px%27%3BappListContainer.style.overflowY%3Dapps.length>10%3F%27scroll%27%3A%27hidden%27%3BappListContainer.style.border%3D%271px solid %23eee%27%3BappListContainer.style.borderRadius%3D%274px%27%3BappListContainer.style.padding%3D%2710px%27%3BappListContainer.style.marginBottom%3D%2715px%27%3Bapps.forEach%28function%28app%29%7Bvar appItem%3Ddocument.createElement%28%27button%27%29%3BappItem.textContent%3Dapp.name%3BappItem.style.display%3D%27block%27%3BappItem.style.width%3D%27100%25%27%3BappItem.style.padding%3D%2710px%27%3BappItem.style.marginBottom%3D%275px%27%3BappItem.style.border%3D%271px solid %23ddd%27%3BappItem.style.borderRadius%3D%274px%27%3BappItem.style.backgroundColor%3D%27%23f9f9f9%27%3BappItem.style.textAlign%3D%27left%27%3BappItem.style.cursor%3D%27pointer%27%3BappItem.style.transition%3D%27background-color 0.2s ease%27%3BappItem.onmouseover%3Dfunction%28%29%7Bthis.style.backgroundColor%3D%27%23e6e6e6%27%3B%7D%3BappItem.onmouseout%3Dfunction%28%29%7Bthis.style.backgroundColor%3D%27%23f9f9f9%27%3B%7D%3BappItem.onclick%3Dfunction%28%29%7Bvar selectedAppId%3Dapp.appmoduleid%3Bvar recordId%3DXrm.Page.data.entity.getId%28%29%3Bvar entityName%3DXrm.Page.data.entity.getEntityName%28%29%3Bvar url%3D%60/main.aspx%3Fappid%3D%24%7BselectedAppId%7D%26pagetype%3Dentityrecord%26etn%3D%24%7BentityName%7D%26id%3D%24%7BrecordId%7D%60%3Bwindow.open%28url%2C%27_blank%27%29%3Bdocument.body.removeChild%28modal%29%3B%7D%3BappListContainer.appendChild%28appItem%29%3B%7D%29%3Bmodal.appendChild%28appListContainer%29%3Bvar closeButton%3Ddocument.createElement%28%27button%27%29%3BcloseButton.textContent%3D%27Fechar%27%3BcloseButton.style.padding%3D%2710px 20px%27%3BcloseButton.style.border%3D%27none%27%3BcloseButton.style.borderRadius%3D%274px%27%3BcloseButton.style.backgroundColor%3D%27%23dc3545%27%3BcloseButton.style.color%3D%27%23fff%27%3BcloseButton.style.cursor%3D%27pointer%27%3BcloseButton.style.float%3D%27right%27%3BcloseButton.onclick%3Dfunction%28%29%7Bdocument.body.removeChild%28modal%29%3B%7D%3Bmodal.appendChild%28closeButton%29%3Bdocument.body.appendChild%28modal%29%3B%7D%0Afetch%28%27/api/data/v9.1/appmodules%27%2C%7Bmethod%3A%27GET%27%2Cheaders%3A%7B%27OData-MaxVersion%27%3A%274.0%27%2C%27OData-Version%27%3A%274.0%27%2C%27Accept%27%3A%27application/json%27%2C%27Content-Type%27%3A%27application/json%3B charset%3Dutf-8%27%7D%7D%29.then%28response%3D>%7Bif%28%21response.ok%29%7Bthrow new Error%28%27Network response was not ok %27+response.statusText%29%3B%7D%0Areturn response.json%28%29%3B%7D%29.then%28data%3D>%7BshowModal%28data.value%29%3B%7D%29.catch%28error%3D>%7Balert%28%27Error fetching apps%3A %27+error.message%29%3B%7D%29%3B%7D%29%28%29%3B
