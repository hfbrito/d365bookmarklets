javascript:javascript%3A%28function%28%29%7Bconst SPACE_CHAR%3D%27%5Cu0020%27%3Bfunction showEntitySelectionModal%28entities%29%7Bvar modal%3Ddocument.createElement%28%27div%27%29%3Bmodal.style.position%3D%27fixed%27%3Bmodal.style.top%3D%2750%25%27%3Bmodal.style.left%3D%2750%25%27%3Bmodal.style.transform%3D%27translate%28-50%25%2C%27+SPACE_CHAR+%27-50%25%29%27%3Bmodal.style.padding%3D%2720px%27%3Bmodal.style.backgroundColor%3D%27%23fff%27%3Bmodal.style.boxShadow%3D%270%27+SPACE_CHAR+%270%27+SPACE_CHAR+%2710px%27+SPACE_CHAR+%27rgba%280%2C0%2C0%2C0.5%29%27%3Bmodal.style.zIndex%3D%2710000%27%3Bmodal.style.borderRadius%3D%278px%27%3Bmodal.style.fontFamily%3D%27Arial%2C%27+SPACE_CHAR+%27sans-serif%27%3Bmodal.style.maxHeight%3D%2780%25%27%3Bmodal.style.overflowY%3D%27auto%27%3Bmodal.style.width%3D%27min%2890vw%2C 700px%29%27%3Bmodal.style.maxWidth%3D%2760%25%27%3Bvar title%3Ddocument.createElement%28%27h3%27%29%3Btitle.textContent%3D%27Selecione%27+SPACE_CHAR+%27uma%27+SPACE_CHAR+%27Tabela%27+SPACE_CHAR+%27do%27+SPACE_CHAR+%27Dynamics%27+SPACE_CHAR+%27365%27%3Btitle.style.marginBottom%3D%2715px%27%3Btitle.style.color%3D%27%23333%27%3Btitle.style.textAlign%3D%27center%27%3Bmodal.appendChild%28title%29%3Bvar searchInput%3Ddocument.createElement%28%27input%27%29%3BsearchInput.type%3D%27text%27%3BsearchInput.placeholder%3D%27Pesquisar%27+SPACE_CHAR+%27tabela...%27%3BsearchInput.style.width%3D%27calc%28100%25 - 20px%29%27%3BsearchInput.style.padding%3D%2710px%27%3BsearchInput.style.marginBottom%3D%2715px%27%3BsearchInput.style.border%3D%271px%27+SPACE_CHAR+%27solid%27+SPACE_CHAR+%27%23ccc%27%3BsearchInput.style.borderRadius%3D%274px%27%3BsearchInput.style.boxSizing%3D%27border-box%27%3Bmodal.appendChild%28searchInput%29%3Bvar entityListContainer%3Ddocument.createElement%28%27div%27%29%3BentityListContainer.style.maxHeight%3D%27480px%27%3BentityListContainer.style.overflowY%3D%27scroll%27%3BentityListContainer.style.border%3D%271px%27+SPACE_CHAR+%27solid%27+SPACE_CHAR+%27%23eee%27%3BentityListContainer.style.borderRadius%3D%274px%27%3BentityListContainer.style.padding%3D%2710px%27%3BentityListContainer.style.marginBottom%3D%2715px%27%3Bmodal.appendChild%28entityListContainer%29%3Bfunction renderEntityList%28filterText%3D%27%27%29%7BentityListContainer.innerHTML%3D%27%27%3Bconst lowerCaseFilter%3DfilterText.toLowerCase%28%29%3Bconst filteredEntities%3Dentities.filter%28entity%3D>entity.LogicalName.toLowerCase%28%29.includes%28lowerCaseFilter%29%7C%7C%28entity.DisplayName%26%26entity.DisplayName.toLowerCase%28%29.includes%28lowerCaseFilter%29%29%29%3Bif%28filteredEntities.length%3D%3D%3D0%26%26filterText%21%3D%3D%27%27%29%7Bvar noResults%3Ddocument.createElement%28%27p%27%29%3BnoResults.textContent%3D%27Nenhuma%27+SPACE_CHAR+%27tabela%27+SPACE_CHAR+%27encontrada%27+SPACE_CHAR+%27com%27+SPACE_CHAR+%27este%27+SPACE_CHAR+%27termo.%27%3BnoResults.style.textAlign%3D%27center%27%3BnoResults.style.color%3D%27%23777%27%3BentityListContainer.appendChild%28noResults%29%3B%7D%0AfilteredEntities.forEach%28function%28entity%29%7Bvar entityItem%3Ddocument.createElement%28%27button%27%29%3BentityItem.textContent%3D%60%24%7Bentity.DisplayName%7D%24%7BSPACE_CHAR%7D%28%24%7Bentity.LogicalName%7D%29%60%3BentityItem.style.display%3D%27block%27%3BentityItem.style.width%3D%27100%25%27%3BentityItem.style.padding%3D%2710px%27%3BentityItem.style.marginBottom%3D%275px%27%3BentityItem.style.border%3D%271px%27+SPACE_CHAR+%27solid%27+SPACE_CHAR+%27%23ddd%27%3BentityItem.style.borderRadius%3D%274px%27%3BentityItem.style.backgroundColor%3D%27%23f9f9f9%27%3BentityItem.style.textAlign%3D%27left%27%3BentityItem.style.cursor%3D%27pointer%27%3BentityItem.style.transition%3D%27background-color%27+SPACE_CHAR+%270.2s%27+SPACE_CHAR+%27ease%27%3BentityItem.onmouseover%3Dfunction%28%29%7Bthis.style.backgroundColor%3D%27%23e6e6e6%27%3B%7D%3BentityItem.onmouseout%3Dfunction%28%29%7Bthis.style.backgroundColor%3D%27%23f9f9f9%27%3B%7D%3BentityItem.onclick%3Dfunction%28%29%7Bvar selectedEntityLogicalName%3Dentity.LogicalName%3Bvar globalContext%3DXrm.Utility.getGlobalContext%28%29%3Bvar url%3DglobalContext.getClientUrl%28%29%3BglobalContext.getCurrentAppProperties%28%29.then%28function success%28app%29%7Blet IdApp%3Dapp.appId%3Blet urlToOpen%3Durl+"/main.aspx%3Fappid%3D"+IdApp+"%26newWindow%3Dtrue%26pagetype%3Dentitylist%26etn%3D"+encodeURIComponent%28selectedEntityLogicalName%29%3BXrm.Navigation.openUrl%28urlToOpen%29%3Bdocument.body.removeChild%28modal%29%3B%7D%2Cfunction errorCallback%28%29%7Balert%28"Erro"+SPACE_CHAR+"ao"+SPACE_CHAR+"obter"+SPACE_CHAR+"as"+SPACE_CHAR+"propriedades"+SPACE_CHAR+"do"+SPACE_CHAR+"aplicativo."%29%3Bdocument.body.removeChild%28modal%29%3B%7D%29%3B%7D%3BentityListContainer.appendChild%28entityItem%29%3B%7D%29%3B%7D%0AsearchInput.addEventListener%28%27input%27%2Cfunction%28%29%7BrenderEntityList%28this.value%29%3B%7D%29%3BrenderEntityList%28%29%3Bvar closeButton%3Ddocument.createElement%28%27button%27%29%3BcloseButton.textContent%3D%27Fechar%27%3BcloseButton.style.padding%3D%2710px%27+SPACE_CHAR+%2720px%27%3BcloseButton.style.border%3D%27none%27%3BcloseButton.style.borderRadius%3D%274px%27%3BcloseButton.style.backgroundColor%3D%27%23dc3545%27%3BcloseButton.style.color%3D%27%23fff%27%3BcloseButton.style.cursor%3D%27pointer%27%3BcloseButton.style.float%3D%27right%27%3BcloseButton.onclick%3Dfunction%28%29%7Bdocument.body.removeChild%28modal%29%3B%7D%3Bmodal.appendChild%28closeButton%29%3Bdocument.body.appendChild%28modal%29%3BsearchInput.focus%28%29%3B%7D%0Avar webApiUrl%3DXrm.Utility.getGlobalContext%28%29.getClientUrl%28%29+"/api/data/v9.1/EntityDefinitions%3F%24select%3DLogicalName%2CDisplayName"%3Bfetch%28webApiUrl%2C%7Bmethod%3A%27GET%27%2Cheaders%3A%7B%27OData-MaxVersion%27%3A%274.0%27%2C%27OData-Version%27%3A%274.0%27%2C%27Accept%27%3A%27application/json%27%2C%27Content-Type%27%3A%27application/json%3B%27+SPACE_CHAR+%27charset%3Dutf-8%27%2C%27Prefer%27%3A%27odata.include-annotations%3D"*"%27%2C%7D%7D%29.then%28response%3D>%7Bif%28%21response.ok%29%7Breturn response.json%28%29.then%28errorData%3D>%7Bconst errorMessage%3DerrorData%26%26errorData.error%26%26errorData.error.message%3FerrorData.error.message%3Aresponse.statusText%3Bthrow new Error%28%60Erro%60+SPACE_CHAR+%60de%60+SPACE_CHAR+%60rede%60+SPACE_CHAR+%60ou%60+SPACE_CHAR+%60API%3A%60+SPACE_CHAR+%60%24%7Bresponse.status%7D%60+SPACE_CHAR+%60-%60+SPACE_CHAR+%60%24%7BerrorMessage%7D%60%29%3B%7D%29.catch%28%28%29%3D>%7Bthrow new Error%28%27Network%27+SPACE_CHAR+%27response%27+SPACE_CHAR+%27was%27+SPACE_CHAR+%27not%27+SPACE_CHAR+%27ok%27+SPACE_CHAR+%27%28Verifique%27+SPACE_CHAR+%27as%27+SPACE_CHAR+%27permiss%5Cu00f5es%27+SPACE_CHAR+%27ou%27+SPACE_CHAR+%27conex%5Cu00e3o%29.%27%29%3B%7D%29%3B%7D%0Areturn response.json%28%29%3B%7D%29.then%28data%3D>%7Bconst entities%3Ddata.value.map%28entity%3D>%28%7BLogicalName%3Aentity.LogicalName%2CDisplayName%3Aentity.DisplayName%26%26entity.DisplayName.LocalizedLabels%26%26entity.DisplayName.LocalizedLabels.length>0%3Fentity.DisplayName.LocalizedLabels%5B0%5D.Label%3Aentity.LogicalName%2CPluralName%3Anull%7D%29%29.filter%28entity%3D>entity.DisplayName%29.sort%28%28a%2Cb%29%3D>a.DisplayName.localeCompare%28b.DisplayName%29%29%3Bif%28entities.length%3D%3D%3D0%29%7Balert%28%27Nenhuma%27+SPACE_CHAR+%27tabela%27+SPACE_CHAR+%27encontrada%27+SPACE_CHAR+%27ou%27+SPACE_CHAR+%27o%27+SPACE_CHAR+%27usu%5Cu00e1rio%27+SPACE_CHAR+%27n%5Cu00e3o%27+SPACE_CHAR+%27tem%27+SPACE_CHAR+%27permiss%5Cu00e3o%27+SPACE_CHAR+%27para%27+SPACE_CHAR+%27ler%27+SPACE_CHAR+%27os%27+SPACE_CHAR+%27metadados.%27+SPACE_CHAR+%27Tente%27+SPACE_CHAR+%27novamente%27+SPACE_CHAR+%27ou%27+SPACE_CHAR+%27verifique%27+SPACE_CHAR+%27as%27+SPACE_CHAR+%27permiss%5Cu00f5es.%27%29%3Breturn%3B%7D%0AshowEntitySelectionModal%28entities%29%3B%7D%29.catch%28error%3D>%7Bconsole.error%28%27Erro%27+SPACE_CHAR+%27ao%27+SPACE_CHAR+%27buscar%27+SPACE_CHAR+%27tabelas%3A%27%2Cerror%29%3Balert%28%27Erro%27+SPACE_CHAR+%27ao%27+SPACE_CHAR+%27buscar%27+SPACE_CHAR+%27tabelas%3A%27+SPACE_CHAR+error.message+%27.%27+SPACE_CHAR+%27Poss%5Cu00edveis%27+SPACE_CHAR+%27causas%3A%27+SPACE_CHAR+%27permiss%5Cu00f5es%27+SPACE_CHAR+%27insuficientes%2C%27+SPACE_CHAR+%27URL%27+SPACE_CHAR+%27da%27+SPACE_CHAR+%27API%27+SPACE_CHAR+%27incorreta%27+SPACE_CHAR+%27ou%27+SPACE_CHAR+%27bloqueio%27+SPACE_CHAR+%27de%27+SPACE_CHAR+%27rede.%27%29%3B%7D%29%3B%7D%29%28%29%3B
